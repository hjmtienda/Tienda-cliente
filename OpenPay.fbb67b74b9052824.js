(function(){var u,g={}.hasOwnProperty,y=function(c,o){function t(){this.constructor=o}for(var e in c)g.call(c,e)&&(o[e]=c[e]);return t.prototype=c.prototype,o.prototype=new t,o.__super__=c.prototype,o},v=this;this.OpenPay=function(){function c(){}function o(r,i,s,h,d){clearTimeout(i),i=null,s=s||"Unknown error",h=h||0,d=d||"{}";try{i=JSON.parse(d)}catch{s="Response error"}r({message:s,status:h,data:i,toString:function(){return this.message+" [status "+this.status+"]"}})}function t(r,i,s){if(void 0!==i&&/^[a-z0-9]+$/i.test(i)){if(void 0!==s&&/^pk_[a-z0-9]+$/i.test(s))return 1;o(r,null,"Empty or invalid Openpay API Key")}else o(r,null,"Empty or invalid Openpay ID")}function e(r,i,s,h,d,p){var m,l=null,f=null,_={};if("function"!=typeof h&&(h=c.log),"function"!=typeof d&&(d=c.log),typeof JSON<"u"){var x=XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;if(x){let b=function(){if(typeof l.readyState<"u"&&4==l.readyState||!x)if(clearTimeout(f),l.status<200||300<=l.status)o(d,f,"Request error",l.status,l.responseText);else{var A;try{A=JSON.parse(l.responseText)}catch{o(d,f,"Response error (JSON parse failed)",l.status,"{}")}h({data:A,status:200})}};if(l=function(){if("function"==(R=typeof(A=window).XMLHttpRequest)||"object"==R&&A.XMLHttpRequest||"unknown"==R)return new XMLHttpRequest;var A,R}()){for(var E in m=JSON.stringify(s),_={Accept:"application/json","Content-Type":"application/json",Authorization:"Basic "+i},l.open(p=p??"POST",r,!0),"withCredentials"in l&&(l.withCredentials=!0),_)_.hasOwnProperty(E)&&_[E]&&"setRequestHeader"in l&&l.setRequestHeader(E,_[E]);"onreadystatechange"in l?l.onreadystatechange=b:"onload"in l&&"onerror"in l&&(l.onload=b,l.onerror=o),f=setTimeout(function(){"onload"in l?l.onload=Function.prototype:l.onreadystatechange=Function.prototype,l.abort(),l=null,o(d,f,"Timeout after 40000 milliseconds")},4e4),l.send(m)}else o(d,f,"Browser error (CORS not supported)")}else typeof XDomainRequest<"u"?(s.apiKey=i,$jsonp.send({callbackName:"getResultData",onSuccess:function(b){b.error?o(d,f,"Request error",b.httpStatus,JSON.stringify(b)):h({data:b.data,status:200})},onError:o,timeout:4e4,url:r+"/jsonp",data:s})):o(d,f,"Browser error (CORS not supported)")}else o(d,f,"Browser error (JSON library not found)")}function n(r){return btoa(r+":")}function a(){return c.sandboxMode?c.sandboxHostname:c.developMode?c.developHostname:c.hostname}return c.version=1,c.sandboxMode=!1,c.developMode=!1,c.hostname="https://api.openpay.pe/v1/",c.sandboxHostname="https://sandbox-api.openpay.pe/v1/",c.developHostname="https://dev-api.openpay.pe/v1/",c.Group={},c.Update={},c.setSandboxMode=function(r){c.sandboxMode=!!r,r&&(c.developMode=!1)},c.getSandboxMode=function(){return c.sandboxMode},c.setDevelopMode=function(r){c.developMode=!!r,r&&(c.sandboxMode=!1)},c.getDevelopMode=function(){return c.developMode},c.setId=function(r){c.id=r},c.getId=function(){return c.id},c.setApiKey=function(r){c.key=r},c.getApiKey=function(){return c.key},c.Group.setId=function(r){c.Group.id=r},c.Group.getId=function(){return c.Group.id},c.Group.setApiKey=function(r){c.Group.key=r},c.Group.getApiKey=function(){return c.Group.key},c.log=function(r){"object"==typeof r&&"toString"in r&&(r=r.toString()),typeof console<"u"&&"log"in console&&console.log(r)},c.validate=function(r,i){if(!r)throw i+" required";if("object"!=typeof r)throw i+" invalid"},c.formatData=function(r,i){return r},c.extractFormInfo=function(r){var i,s,h,d=function(m,l){for(var f,_=[],w=m.children,x=0;x<w.length;x++)1===(f=w[x]).nodeType&&f.attributes[l]?_.push(f):0<f.children.length&&(_=_.concat(d(f,l)));return _},p=function(m,l){for(var f={},_=0;_<m.length;_++)fieldName=m[_].attributes[l].value,inputValue=m[_].value,void 0!==f[fieldName]?(f[fieldName].push||(f[this.name]=[f[this.name]]),f[fieldName].push(inputValue||"")):f[fieldName]=inputValue||"";return f};return h=r,r=window.jQuery&&h instanceof jQuery?h[0]:h.nodeType&&1===h.nodeType?h:document.getElementById(h),i=p(d(r,"data-openpay-card"),"data-openpay-card"),void 0!==(r=d(r,"data-openpay-card-address"))&&r.length&&0<r.length&&void 0!==(s=p(r,"data-openpay-card-address"))&&(i.address=s),i},c.send=function(r,i,s,h){if(t(h,c.id,c.key)){var d=n(c.key);return e(a()+c.id+"/"+r,d,i,s,h)}},c.Group.send=function(r,i,s,h){if(t(h,c.Group.id,c.Group.key)){var d=n(c.Group.key);return e(a()+"groups/"+c.Group.id+"/"+r,d,i,s,h)}},c.Update.send=function(r,i,s,h,d){var p="";if(r){if(!t(h,c.Group.id,c.Group.key))return;p=n(c.Group.key)}else{if(!t(h,c.id,c.key))return;p=n(c.key)}return e(a()+d,p,i,s,h,"PUT")},c}.call(this),u=this.OpenPay,this.OpenPay.card=function(c){function o(){return o.__super__.constructor.apply(this,arguments)}return y(c,o),o.validateCardNumber=function(t){return t=(t+"").replace(/\s+|-/g,""),/^\d+$/.test(t)&&10<=t.length&&t.length<=19&&o.luhnCheck(t)&&o.validateCardNumberLength(t)&&o.validateAcceptCardNumber(t)},o.validateCVC=function(t,e){switch(arguments.length){case 1:return t=u.utils.trim(t),/^\d+$/.test(t)&&3<=t.length&&t.length<=4;case 2:return"American Express"==o.cardType(e)?(t=u.utils.trim(t),/^\d+$/.test(t)&&4==t.length):(t=u.utils.trim(t),/^\d+$/.test(t)&&3==t.length);default:return!1}},o.validateExpiry=function(t,e){return 2===(e=u.utils.trim(e)).length&&(e="20"+e),t=u.utils.trim(t),!!/^\d+$/.test(t)&&!!/^\d+$/.test(e)&&parseInt(t,10)<=12&&1<=parseInt(t,10)&&(e=new Date(e,t),t=new Date,e.setMonth(e.getMonth()-1),e.setMonth(e.getMonth()+1,1),t<e)},o.validateCardNumberLength=function(t){var e;if(e=o.cardAbstract(t)){for(var n=e.length.length;n--;)if(e.length[n]==t.length)return!0;return!1}return 10<=t.length&&t.length<=19},o.validateAcceptCardNumber=function(t){return!0},o.luhnCheck=function(t){for(var e=(t+"").split(""),n=0,a=parseInt(e[t.length-1]),r=e.length-2,i=1;0<=r;r--,i++)n=parseInt(e[r]),i%2!=0&&9<(n*=2)&&(n-=9),a+=n;return a%10==0},o.cardType=function(t){var e;return(e=o.cardAbstract(t))?e.name:""},o.cardTypes=function(){return{visa_electron:{name:"Visa Electron",regx:/^(4026|417500|4508|4844|491(3|7))/,length:[16],accept:!0},visa:{name:"Visa",regx:/^4/,length:[16],accept:!0},mastercard:{name:"Mastercard",regx:/^5[1-5]/,length:[16],accept:!0},amex:{name:"American Express",regx:/^3[47]/,length:[15],accept:!0},diners_cb:{name:"Diners Club Carte Blanche",regx:/^30[0-5]/,length:[14],accept:!0},diners_int:{name:"Diners Club International",regx:/^36/,length:[14],accept:!0},jcb:{name:"JCB",regx:/^35(2[89]|[3-8][0-9])/,length:[16],accept:!0},laser:{name:"Laser",regx:/^(6304|670[69]|6771)/,length:[16,17,18,19],accept:!0},maestro:{name:"Maestro",regx:/^(5018|5020|5038|6304|6759|676[1-3])/,length:[12,13,14,15,16,17,18,19],accept:!0},discover:{name:"Discover",regx:/^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)/,length:[16],accept:!0}}},o.cardAbstract=function(t){var e,n;for(e in n=o.cardTypes())if(_cardObj=n[e],t.match(_cardObj.regx))return _cardObj;return!1},o.whitelistedAttrs=["holder_name","cvv2","expiration_month","expiration_year"],o.extractFormAndUpdateCard=function(t,e,n,a,r){return t=u.extractFormInfo(t),o.update(t,e,n,a,r)},o.update=function(t,e,n,a,r){var i="/"+this.getId();return null!=a&&(i=i+"/customers/"+a),null!=r&&(i=i+"/cards/"+r),u.formatData(t,o.whitelistedAttrs),u.Update.send(!1,t,e,n,i)},o}.call(this,this.OpenPay),this.OpenPay.token=function(c){function o(){return o.__super__.constructor.apply(this,arguments)}return y(c,o),o.whitelistedAttrs=["card_number","holder_name","cvv2","expiration_month","expiration_year","address"],o.extractFormAndCreate=function(t,e,n,a){return t=u.extractFormInfo(t),o.create(t,e,n)},o.create=function(t,e,n){return u.validate(t,"tarjeta"),u.formatData(t,o.whitelistedAttrs),u.send("tokens",t,e,n)},o}.call(this,this.OpenPay),this.OpenPay.Group.token=function(c){function o(){return o.__super__.constructor.apply(this,arguments)}return y(c,o),o.whitelistedAttrs=["card_number","holder_name","cvv2","expiration_month","expiration_year","address"],o.extractFormAndCreate=function(t,e,n,a){return t=u.extractFormInfo(t),o.create(t,e,n)},o.create=function(t,e,n){return u.validate(t,"tarjeta"),u.formatData(t,o.whitelistedAttrs),u.Group.send("tokens",t,e,n)},o}.call(this,this.OpenPay),this.OpenPay.Group.card=function(c){function o(){return o.__super__.constructor.apply(this,arguments)}return y(c,o),o.whitelistedAttrs=["holder_name","cvv2","expiration_month","expiration_year"],o.extractFormAndUpdateCard=function(t,e,n,a,r){return t=u.extractFormInfo(t),o.update(t,e,n,a,r)},o.update=function(t,e,n,a,r){return r="groups/"+this.Group.id+"/customers/"+a+"/cards/"+r,t.merchant_id||(t.merchant_id=this.getId()),u.formatData(t,o.whitelistedAttrs),u.Update.send(!0,t,e,n,r)},o}.call(this,this.OpenPay),this.OpenPay.utils=function(c){function o(){}return y(c,o),o.trim=function(t){return(t+"").replace(/^\s+|\s+$/g,"")},o.underscore=function(t){return(t+"").replace(/([A-Z])/g,function(e){return"_"+e.toLowerCase()}).replace(/-/g,"_")},o.underscoreKeys=function(t){var e,n,a=[];for(n in t)e=t[n],delete t[n],a.push(t[this.underscore(n)]=e);return a},o.isElement=function(t){return"object"==typeof t&&(typeof jQuery<"u"&&null!==jQuery&&t instanceof jQuery||1===t.nodeType)},o}.call(this,this.OpenPay),typeof module<"u"&&null!==module&&(module.exports=this.OpenPay),"function"==typeof define&&define("openpay",[],function(){return v.OpenPay})}).call(this);var base64={PADCHAR:"=",ALPHA:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",makeDOMException:function(){try{return new DOMException(DOMException.INVALID_CHARACTER_ERR)}catch{var u=new Error("DOM Exception 5");return u.code=u.number=5,u.name=u.description="INVALID_CHARACTER_ERR",u.toString=function(){return"Error: "+u.name+": "+u.message},u}},getbyte64:function(u,g){if(-1===(u=base64.ALPHA.indexOf(u.charAt(g))))throw base64.makeDOMException();return u},decode:function(u){var g,y,v=base64.getbyte64,c=(u=""+u).length;if(0===c)return u;if(c%4!=0)throw base64.makeDOMException();g=0,u.charAt(c-1)===base64.PADCHAR&&(g=1,u.charAt(c-2)===base64.PADCHAR&&(g=2),c-=4);for(var o=[],t=0;t<c;t+=4)y=v(u,t)<<18|v(u,t+1)<<12|v(u,t+2)<<6|v(u,t+3),o.push(String.fromCharCode(y>>16,y>>8&255,255&y));switch(g){case 1:y=v(u,t)<<18|v(u,t+1)<<12|v(u,t+2)<<6,o.push(String.fromCharCode(y>>16,y>>8&255));break;case 2:y=v(u,t)<<18|v(u,t+1)<<12,o.push(String.fromCharCode(y>>16))}return o.join("")},getbyte:function(u,g){if(255<(u=u.charCodeAt(g)))throw base64.makeDOMException();return u},encode:function(u){if(1!==arguments.length)throw new SyntaxError("Not enough arguments");var g,y,v=base64.PADCHAR,c=base64.ALPHA,o=base64.getbyte,t=[],e=(u=""+u).length-u.length%3;if(0===u.length)return u;for(g=0;g<e;g+=3)y=o(u,g)<<16|o(u,g+1)<<8|o(u,g+2),t.push(c.charAt(y>>18)),t.push(c.charAt(y>>12&63)),t.push(c.charAt(y>>6&63)),t.push(c.charAt(63&y));switch(u.length-e){case 1:y=o(u,g)<<16,t.push(c.charAt(y>>18)+c.charAt(y>>12&63)+v+v);break;case 2:y=o(u,g)<<16|o(u,g+1)<<8,t.push(c.charAt(y>>18)+c.charAt(y>>12&63)+c.charAt(y>>6&63)+v)}return t.join("")}};window.btoa||(window.btoa=base64.encode),window.atob||(window.atob=base64.decode);var $jsonp={send:function(n){var y=(new Date).getTime(),v=n.callbackName||"callback",c=n.onSuccess||function(){},o=n.onError||function(){},t=n.timeout||4e3,e=n.url||"";n=n.data||{},dataIdName="idData";var a=encodeURIComponent;n.callback="var "+dataIdName+"="+ ++y+";"+v,window[dataIdName]=void 0;var r=function(d,p,m){var l,f;for(l in null==p&&(p=[]),d)f=d[l],m&&(l=m+"."+l),"object"==typeof f?r(f,p,l):p.push((""+l).replace(/[\-_\s]+(.)?/g,function(_,w){return w?w.toUpperCase():""}).replace(/^([A-Z])/,function(_,w){return w?w.toLowerCase():""})+"="+a(f));return p.join("&").replace(/%20/g,"+")};timeout_trigger=window.setTimeout(function(){window[v]=function(){},o("Timeout after "+t+" milliseconds")},t);var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=e+"?"+r(n);var s=function(){var d;null!=(d=i.parentNode)&&d.removeChild(i)},h=function(){window.clearTimeout(timeout_trigger),s(),o("There was an error, please verify your authentication data or conection.")};"onreadystatechange"in i?i.onreadystatechange=function(){"loaded"==i.readyState&&typeof window[dataIdName]>"u"&&h()}:"onerror"in i&&(i.onerror=function(){h()}),window[v]=function(d){window.clearTimeout(timeout_trigger),s(),c(d)},document.getElementsByTagName("head")[0].appendChild(i)}};typeof jQuery<"u"&&function(u){void 0!==u&&(u.fn.cardNumberInput=function(){return u(this).restrictedInput("card")},u.fn.numericInput=function(){return u(this).restrictedInput("numeric")},u.fn.restrictedInput=function(g){var y=u(this),v=[{type:"amex",regex:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:15},{type:"other",format:/(\d{1,4})/g,length:16}],c=function(n){var a,r;for(n=(n+"").replace(/\D/g,""),r=0;r<v.length;r++)if((a=v[r]).regex&&a.regex.test(n))return a},o=function(n){return!(!n.metaKey&&!n.ctrlKey)||0===n.which||32!==n.which&&(n.which<33||(n=String.fromCharCode(n.which),!!/[\d\s]/.test(n)))},t=function(i){var a=(u(i.currentTarget).val()+String.fromCharCode(i.which)).replace(/\D/g,""),r=o(i);return(i=c(a))?r&&a.length<=i.length:r&&a.length<=16},e=function(n){var a=u(n.currentTarget),r=a.val(),i=String.fromCharCode(n.which),s=(r.replace(/\D/g,"")+i).length,h=16,d=c(r+i);if(/^\d+$/.test(i)&&!((h=d?d.length:h)<=s))return(d=d&&"amex"===d.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/).test(r)?(n.preventDefault(),setTimeout(function(){return a.val(r+" "+i)})):d.test(r+i)?(n.preventDefault(),setTimeout(function(){return a.val(r+i+" ")})):void 0};return"card"===g?y.on("keypress",t).on("keypress",e).on("keydown",function(n){var a=u(n.currentTarget),r=a.val();if(8===n.which)return/\d\s$/.test(r)?(n.preventDefault(),setTimeout(function(){return a.val(r.replace(/\d\s$/,""))})):/\s\d?$/.test(r)?(n.preventDefault(),setTimeout(function(){return a.val(r.replace(/\s\d?$/,""))})):void 0}).on("paste",t).on("paste",e).on("change",e).on("input",e):"numeric"===g&&y.on("keypress",o).on("paste",o).on("change",o).on("input",o),this})}(jQuery),function(){var u=function(){},g=function(){},y=function(){};function v(){return void 0===u._deviceDataId&&(u._deviceDataId=o.codec.base64.fromBits(o.random.randomWords(6,0)).replace(/[\+\/]/g,"0")),u._deviceDataId}u._hostname="https://api.openpay.mx/",u._sandboxHostname="https://sandbox-api.openpay.mx/",u._developHostname="https://dev-api.openpay.mx/",u._deviceDataId=void 0,u.setup=function(t,e){var n=v();if(t&&document.getElementById(t)){var a=document.createElement("input");a.setAttribute("type","hidden"),a.value=n,a.name=e||"deviceDataId",a.id=e||"deviceDataId",document.getElementById(t).appendChild(a)}var r=!0;try{OpenPay.getId(),OpenPay.getApiKey()}catch{r=!1}if(r){console.log("executing sift mode");var i,s=OpenPay.getId(),h=OpenPay.getApiKey(),d=(i=OpenPay.developMode?u._developHostname:OpenPay.sandboxMode?u._sandboxHostname:u._hostname)+"v1/"+s+"/antifraudkeys";try{OpenPay.getBeaconKey.beaconKey(d,h,"",n,i)}catch(p){console.log("continue without beaconkey"+p)}}return function c(){var t=v();return function(n,a,r){var i=n+"antifraud/"+a+"/components?s="+r;if(window.XDomainRequest){var s=new XDomainRequest;s.open("GET",i),s.onload=function(){document.body.insertAdjacentHTML("beforeend",s.responseText)},setTimeout(function(){s.send()},0)}else xmlhttp=new XMLHttpRequest,xmlhttp.onreadystatechange=function(){4==xmlhttp.readyState&&200==xmlhttp.status&&document.body.insertAdjacentHTML("beforeend",xmlhttp.responseText)},xmlhttp.open("GET",i,!0),xmlhttp.send()}(OpenPay.developMode?u._developHostname:OpenPay.sandboxMode?u._sandboxHostname:u._hostname,OpenPay.getId(),t),v()}()},y.beaconKey=function(t,e,n,a,r){var i=null,s=null,h=t,d={},p=btoa(e+":"),m={};function l(E,b,C){clearTimeout(s),C=C||"{}";try{JSON.parse(C)}catch{}}if(typeof JSON<"u"){var f=XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;if(f){let E=function(){if(typeof i.readyState<"u"&&4==i.readyState||!f)if(clearTimeout(s),i.status<200||300<=i.status)l(0,0,i.responseText);else try{var b=i.responseText;b=(b=b.replace("(","")).replace(")","");var C=JSON.parse(b).data;console.log("beaconKey ok"),0<C.length?OpenPay.deviceDataSC.setupSC(n,a,C,r):console.log("Empty beaconKey normal in Sandbox")}catch{l(0,0,"{}")}};if(!(i=function(){if("function"==(R=typeof(A=window)["XMLHttpRequest"])||"object"==R&&A.XMLHttpRequest||"unknown"==R)return new XMLHttpRequest;var A,R}()))return void l();for(var _ in d={Accept:"application/json","Content-Type":"application/json",Authorization:"Basic "+p},i.open("GET",h,!0),"withCredentials"in i&&(i.withCredentials=!0),d)d.hasOwnProperty(_)&&d[_]&&"setRequestHeader"in i&&i.setRequestHeader(_,d[_]);"onreadystatechange"in i?i.onreadystatechange=E:"onload"in i&&"onerror"in i&&(i.onload=E,i.onerror=l),s=setTimeout(function(){"onload"in i?i.onload=Function.prototype:i.onreadystatechange=Function.prototype,i.abort(),i=null,l()},4e4),i.send()}else{if(typeof XDomainRequest>"u")return void l();m.apiKey=p,$jsonp.send({callbackName:"getResultData",onSuccess:function(E){if(E.error)l(0,0,JSON.stringify(E));else try{var b=E.data;console.log("beaconKey ok"),0<b.length?OpenPay.deviceDataSC.setupSC(n,a,b,r):console.log("Empty beaconKey normal in Sandbox")}catch{l(0,0,"{}")}},onError:l,timeout:4e4,url:h+"/jsonp",data:m})}}else l()},g.setupSC=function(t,e,n,a){console.log("Sift Snippet");var r=window._sift=window._sift||[];r.push(["_setAccount",n]),r.push(["_setSessionId",e]),r.push(["_trackPageview"]);var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=a+"antifraud/sc.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(i,s)},OpenPay.deviceData=u,OpenPay.getBeaconKey=y,OpenPay.deviceDataSC=g;var o={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};typeof module<"u"&&module.exports&&(module.exports=o),o.cipher.aes=function(t){this._tables[0][0][0]||this._precompute();var e,n,a,r,i,s=this._tables[0][4],h=this._tables[1],d=t.length,p=1;if(4!==d&&6!==d&&8!==d)throw new o.exception.invalid("invalid aes key size");for(this._key=[r=t.slice(0),i=[]],e=d;e<4*d+28;e++)a=r[e-1],(e%d==0||8===d&&e%d==4)&&(a=s[a>>>24]<<24^s[a>>16&255]<<16^s[a>>8&255]<<8^s[255&a],e%d==0&&(a=a<<8^a>>>24^p<<24,p=p<<1^283*(p>>7))),r[e]=r[e-d]^a;for(n=0;e;n++,e--)a=r[3&n?e:e-4],i[n]=e<=4||n<4?a:h[0][s[a>>>24]]^h[1][s[a>>16&255]]^h[2][s[a>>8&255]]^h[3][s[255&a]]},o.cipher.aes.prototype={encrypt:function(t){return this._crypt(t,0)},decrypt:function(t){return this._crypt(t,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var t,e,n,a,r,i,s,h,d=this._tables[0],p=this._tables[1],m=d[4],l=p[4],f=[],_=[];for(t=0;t<256;t++)_[(f[t]=t<<1^283*(t>>7))^t]=t;for(e=n=0;!m[e];e^=a||1,n=_[n]||1)for(i=(i=n^n<<1^n<<2^n<<3^n<<4)>>8^255&i^99,h=16843009*f[r=f[a=f[l[m[e]=i]=e]]]^65537*r^257*a^16843008*e,s=257*f[i]^16843008*i,t=0;t<4;t++)d[t][e]=s=s<<24^s>>>8,p[t][i]=h=h<<24^h>>>8;for(t=0;t<5;t++)d[t]=d[t].slice(0),p[t]=p[t].slice(0)},_crypt:function(t,e){if(4!==t.length)throw new o.exception.invalid("invalid aes block size");var n,a,r,i,s=this._key[e],h=t[0]^s[0],d=t[e?3:1]^s[1],p=t[2]^s[2],m=t[e?1:3]^s[3],l=s.length/4-2,f=4,_=[0,0,0,0],w=this._tables[e],x=w[0],E=w[1],b=w[2],C=w[3],A=w[4];for(i=0;i<l;i++)n=x[h>>>24]^E[d>>16&255]^b[p>>8&255]^C[255&m]^s[f],a=x[d>>>24]^E[p>>16&255]^b[m>>8&255]^C[255&h]^s[f+1],r=x[p>>>24]^E[m>>16&255]^b[h>>8&255]^C[255&d]^s[f+2],m=x[m>>>24]^E[h>>16&255]^b[d>>8&255]^C[255&p]^s[f+3],f+=4,h=n,d=a,p=r;for(i=0;i<4;i++)_[e?3&-i:i]=A[h>>>24]<<24^A[d>>16&255]<<16^A[p>>8&255]<<8^A[255&m]^s[f++],n=h,h=d,d=p,p=m,m=n;return _}},o.bitArray={bitSlice:function(t,e,n){return t=o.bitArray._shiftRight(t.slice(e/32),32-(31&e)).slice(1),void 0===n?t:o.bitArray.clamp(t,n-e)},extract:function(t,e,n){var a=Math.floor(-e-n&31);return(-32&(e+n-1^e)?t[e/32|0]<<32-a^t[e/32+1|0]>>>a:t[e/32|0]>>>a)&(1<<n)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var n=t[t.length-1],a=o.bitArray.getPartial(n);return 32===a?t.concat(e):o.bitArray._shiftRight(e,a,0|n,t.slice(0,t.length-1))},bitLength:function(t){var n=t.length;return 0===n?0:32*(n-1)+o.bitArray.getPartial(t[n-1])},clamp:function(t,e){if(32*t.length<e)return t;var n=(t=t.slice(0,Math.ceil(e/32))).length;return e&=31,0<n&&e&&(t[n-1]=o.bitArray.partial(e,t[n-1]&2147483648>>e-1,1)),t},partial:function(t,e,n){return 32===t?e:(n?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(o.bitArray.bitLength(t)!==o.bitArray.bitLength(e))return!1;var n,a=0;for(n=0;n<t.length;n++)a|=t[n]^e[n];return 0===a},_shiftRight:function(t,e,n,a){var r,s;for(void 0===a&&(a=[]);32<=e;e-=32)a.push(n),n=0;if(0===e)return a.concat(t);for(r=0;r<t.length;r++)a.push(n|t[r]>>>e),n=t[r]<<32-e;return s=o.bitArray.getPartial(t.length?t[t.length-1]:0),a.push(o.bitArray.partial(e+s&31,32<e+s?n:a.pop(),1)),a},_xor4:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]}},o.codec.utf8String={fromBits:function(t){var e,n,a="",r=o.bitArray.bitLength(t);for(e=0;e<r/8;e++)0==(3&e)&&(n=t[e/4]),a+=String.fromCharCode(n>>>24),n<<=8;return decodeURIComponent(escape(a))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,n=[],a=0;for(e=0;e<t.length;e++)a=a<<8|t.charCodeAt(e),3==(3&e)&&(n.push(a),a=0);return 3&e&&n.push(o.bitArray.partial(8*(3&e),a)),n}},o.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,n){var a,r="",i=0,s=o.codec.base64._chars,h=0,d=o.bitArray.bitLength(t);for(n&&(s=s.substr(0,62)+"-_"),a=0;6*r.length<d;)r+=s.charAt((h^t[a]>>>i)>>>26),i<6?(h=t[a]<<6-i,i+=26,a++):(h<<=6,i-=6);for(;3&r.length&&!e;)r+="=";return r},toBits:function(t,e){t=t.replace(/\s|=/g,"");var n,a,r=[],i=0,s=o.codec.base64._chars,h=0;for(e&&(s=s.substr(0,62)+"-_"),n=0;n<t.length;n++){if((a=s.indexOf(t.charAt(n)))<0)throw new o.exception.invalid("this isn't base64!");26<i?(r.push(h^a>>>(i-=26)),h=a<<32-i):h^=a<<32-(i+=6)}return 56&i&&r.push(o.bitArray.partial(56&i,h,1)),r}},o.codec.base64url={fromBits:function(t){return o.codec.base64.fromBits(t,1,1)},toBits:function(t){return o.codec.base64.toBits(t,1)}},o.hash.sha256=function(t){this._key[0]||this._precompute(),t?(this._h=t._h.slice(0),this._buffer=t._buffer.slice(0),this._length=t._length):this.reset()},o.hash.sha256.hash=function(t){return(new o.hash.sha256).update(t).finalize()},o.hash.sha256.prototype={blockSize:512,reset:function(){return this._h=this._init.slice(0),this._buffer=[],this._length=0,this},update:function(t){"string"==typeof t&&(t=o.codec.utf8String.toBits(t));var e,n=this._buffer=o.bitArray.concat(this._buffer,t),a=this._length,r=this._length=a+o.bitArray.bitLength(t);for(e=512+a&-512;e<=r;e+=512)this._block(n.splice(0,16));return this},finalize:function(){var t,e=this._buffer,n=this._h;for(t=(e=o.bitArray.concat(e,[o.bitArray.partial(1,1)])).length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this._length/4294967296)),e.push(0|this._length);e.length;)this._block(e.splice(0,16));return this.reset(),n},_init:[],_key:[],_precompute:function(){var t,e=0,n=2;function a(r){return 4294967296*(r-Math.floor(r))|0}t:for(;e<64;n++){for(t=2;t*t<=n;t++)if(n%t==0)continue t;e<8&&(this._init[e]=a(Math.pow(n,.5))),this._key[e]=a(Math.pow(n,1/3)),e++}},_block:function(t){var e,n,a,r,i=t.slice(0),s=this._h,h=this._key,d=s[0],p=s[1],m=s[2],l=s[3],f=s[4],_=s[5],w=s[6],x=s[7];for(e=0;e<64;e++)n=(n=e<16?i[e]:i[15&e]=((a=i[e+1&15])>>>7^a>>>18^a>>>3^a<<25^a<<14)+((r=i[e+14&15])>>>17^r>>>19^r>>>10^r<<15^r<<13)+i[15&e]+i[e+9&15]|0)+x+(f>>>6^f>>>11^f>>>25^f<<26^f<<21^f<<7)+(w^f&(_^w))+h[e],x=w,w=_,_=f,f=l+n|0,l=m,m=p,d=n+((p=d)&m^l&(p^m))+(p>>>2^p>>>13^p>>>22^p<<30^p<<19^p<<10)|0;s[0]=s[0]+d|0,s[1]=s[1]+p|0,s[2]=s[2]+m|0,s[3]=s[3]+l|0,s[4]=s[4]+f|0,s[5]=s[5]+_|0,s[6]=s[6]+w|0,s[7]=s[7]+x|0}},o.prng=function(t){this._pools=[new o.hash.sha256],this._poolEntropy=[0],this._reseedCount=0,this._robins={},this._eventId=0,this._collectorIds={},this._collectorIdNext=0,this._strength=0,this._poolStrength=0,this._nextReseed=0,this._key=[0,0,0,0,0,0,0,0],this._counter=[0,0,0,0],this._cipher=void 0,this._defaultParanoia=t,this._collectorsStarted=!1,this._callbacks={progress:{},seeded:{}},this._callbackI=0,this._NOT_READY=0,this._READY=1,this._REQUIRES_RESEED=2,this._MAX_WORDS_PER_BURST=65536,this._PARANOIA_LEVELS=[0,48,64,96,128,192,256,384,512,768,1024],this._MILLISECONDS_PER_RESEED=3e4,this._BITS_PER_RESEED=80},o.prng.prototype={randomWords:function(t,e){var n,a,r=[],i=this.isReady(e);if(i===this._NOT_READY)throw new o.exception.notReady("generator isn't seeded");for(i&this._REQUIRES_RESEED&&this._reseedFromPools(!(i&this._READY)),n=0;n<t;n+=4)(n+1)%this._MAX_WORDS_PER_BURST==0&&this._gate(),a=this._gen4words(),r.push(a[0],a[1],a[2],a[3]);return this._gate(),r.slice(0,t)},setDefaultParanoia:function(t,e){if(0===t&&"Setting paranoia=0 will ruin your security; use it only for testing"!==e)throw"Setting paranoia=0 will ruin your security; use it only for testing";this._defaultParanoia=t},addEntropy:function(t,e,n){n=n||"user";var a,r,i,s,h=(new Date).valueOf(),d=this._robins[n],p=this.isReady(),m=0;switch(void 0===(a=this._collectorIds[n])&&(a=this._collectorIds[n]=this._collectorIdNext++),void 0===d&&(d=this._robins[n]=0),this._robins[n]=(this._robins[n]+1)%this._pools.length,typeof t){case"number":void 0===e&&(e=1),this._pools[d].update([a,this._eventId++,1,e,h,1,0|t]);break;case"object":if("[object Uint32Array]"===(s=Object.prototype.toString.call(t))){for(i=[],r=0;r<t.length;r++)i.push(t[r]);t=i}else for("[object Array]"!==s&&(m=1),r=0;r<t.length&&!m;r++)"number"!=typeof t[r]&&(m=1);if(!m){if(void 0===e)for(r=e=0;r<t.length;r++)for(i=t[r];0<i;)e++,i>>>=1;this._pools[d].update([a,this._eventId++,2,e,h,t.length].concat(t))}break;case"string":void 0===e&&(e=t.length),this._pools[d].update([a,this._eventId++,3,e,h,t.length]),this._pools[d].update(t);break;default:m=1}if(m)throw new o.exception.bug("random: addEntropy only supports number, array of numbers or string");this._poolEntropy[d]+=e,this._poolStrength+=e,p===this._NOT_READY&&(this.isReady()!==this._NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._poolStrength)),this._fireEvent("progress",this.getProgress()))},isReady:function(t){var e=this._PARANOIA_LEVELS[void 0!==t?t:this._defaultParanoia];return this._strength&&this._strength>=e?this._poolEntropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._nextReseed?this._REQUIRES_RESEED|this._READY:this._READY:this._poolStrength>=e?this._REQUIRES_RESEED|this._NOT_READY:this._NOT_READY},getProgress:function(t){var e=this._PARANOIA_LEVELS[t||this._defaultParanoia];return this._strength>=e||this._poolStrength>e?1:this._poolStrength/e},startCollectors:function(){if(!this._collectorsStarted){if(this._eventListener={loadTimeCollector:this._bind(this._loadTimeCollector),mouseCollector:this._bind(this._mouseCollector),accelerometerCollector:this._bind(this._accelerometerCollector)},window.addEventListener)window.addEventListener("load",this._eventListener.loadTimeCollector,!1),window.addEventListener("mousemove",this._eventListener.mouseCollector,!1),window.addEventListener("devicemotion",this._eventListener.accelerometerCollector,!1);else{if(!document.attachEvent)throw new o.exception.bug("can't attach event");document.attachEvent("onload",this._eventListener.loadTimeCollector),document.attachEvent("onmousemove",this._eventListener.mouseCollector)}this._collectorsStarted=!0}},stopCollectors:function(){this._collectorsStarted&&(window.removeEventListener?(window.removeEventListener("load",this._eventListener.loadTimeCollector,!1),window.removeEventListener("mousemove",this._eventListener.mouseCollector,!1),window.removeEventListener("devicemotion",this._eventListener.accelerometerCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this._eventListener.loadTimeCollector),document.detachEvent("onmousemove",this._eventListener.mouseCollector)),this._collectorsStarted=!1)},addEventListener:function(t,e){this._callbacks[t][this._callbackI++]=e},removeEventListener:function(t,e){var n,a,r=this._callbacks[t],i=[];for(a in r)r.hasOwnProperty(a)&&r[a]===e&&i.push(a);for(n=0;n<i.length;n++)delete r[a=i[n]]},_bind:function(t){var e=this;return function(){t.apply(e,arguments)}},_gen4words:function(){for(var t=0;t<4&&(this._counter[t]=this._counter[t]+1|0,!this._counter[t]);t++);return this._cipher.encrypt(this._counter)},_gate:function(){this._key=this._gen4words().concat(this._gen4words()),this._cipher=new o.cipher.aes(this._key)},_reseed:function(t){this._key=o.hash.sha256.hash(this._key.concat(t)),this._cipher=new o.cipher.aes(this._key);for(var e=0;e<4&&(this._counter[e]=this._counter[e]+1|0,!this._counter[e]);e++);},_reseedFromPools:function(t){var e,n=[],a=0;for(this._nextReseed=n[0]=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED,e=0;e<16;e++)n.push(4294967296*Math.random()|0);for(e=0;e<this._pools.length&&(n=n.concat(this._pools[e].finalize()),a+=this._poolEntropy[e],this._poolEntropy[e]=0,t||!(this._reseedCount&1<<e));e++);this._reseedCount>=1<<this._pools.length&&(this._pools.push(new o.hash.sha256),this._poolEntropy.push(0)),this._poolStrength-=a,a>this._strength&&(this._strength=a),this._reseedCount++,this._reseed(n)},_mouseCollector:function(t){o.random.addEntropy([t.x||t.clientX||t.offsetX||0,t.y||t.clientY||t.offsetY||0],2,"mouse"),this._addCurrentTimeToEntropy(0)},_loadTimeCollector:function(){this._addCurrentTimeToEntropy(2)},_addCurrentTimeToEntropy:function(t){window&&window.performance&&"function"==typeof window.performance.now?o.random.addEntropy(window.performance.now(),t,"loadtime"):o.random.addEntropy((new Date).valueOf(),t,"loadtime")},_accelerometerCollector:function(t){var e=t.accelerationIncludingGravity.x||t.accelerationIncludingGravity.y||t.accelerationIncludingGravity.z;if(window.orientation){var n=window.orientation;"number"==typeof n&&o.random.addEntropy(n,1,"accelerometer")}e&&o.random.addEntropy(e,2,"accelerometer"),this._addCurrentTimeToEntropy(0)},_fireEvent:function(t,e){var n,a=o.random._callbacks[t],r=[];for(n in a)a.hasOwnProperty(n)&&r.push(a[n]);for(n=0;n<r.length;n++)r[n](e)}},o.random=new o.prng(6),function(){try{var t,e,n;if(typeof module<"u"&&module.exports&&(e=require("crypto"))&&e.randomBytes)t=e.randomBytes(128),t=new Uint32Array(new Uint8Array(t).buffer),o.random.addEntropy(t,1024,"crypto.randomBytes");else if(window&&Uint32Array){if(n=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(n);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)return;window.msCrypto.getRandomValues(n)}o.random.addEntropy(n,1024,"crypto.getRandomValues")}}catch(a){console.log("There was an error collecting entropy from the browser:"),console.log(a)}}()}.call(this);